stage('Configure AWS CLI') {
    steps {
        withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', credentialsId: 'awscredss']]) {
            script {
                // Debugging output
                echo "AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID ?: 'not set'}"
                echo "AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY ?: 'not set'}"

                // Set AWS environment variables for the shell session
                sh '''
                export AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
                export AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
                export AWS_DEFAULT_REGION=us-east-1
                aws configure list
                '''
            }
        }
    }
}
